<!DOCTYPE html><html lang="zh-Hans"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 微信聊天记录读取 · 浮萍's Blog</title><meta name="description" content="微信聊天记录读取 - 浮萍"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/"><link rel="stylesheet" href="/css/apollo.css"><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"><link rel="search" type="application/opensearchdescription+xml" href="http://fuping.site/atom.xml" title="浮萍's Blog"><script src="//code.jquery.com/jquery-2.2.4.min.js" integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44=" crossorigin="anonymous"></script></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">主页</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">所有文章</a></li><li class="nav-list-item"><a href="/tags" target="_self" class="nav-list-link">标签</a></li><li class="nav-list-item"><a href="/about" target="_self" class="nav-list-link">关于</a></li><li class="nav-list-item"><a href="/atom.xml" target="_self" class="nav-list-link">RSS</a></li><li class="nav-list-item"><a href="/search" target="_self" class="nav-list-link search"><i class="fa fa-search" aria-hidden="true"></i></a></li></ul></header><main class="container"></main><div class="post"><article class="post-block"><h1 class="post-title">微信聊天记录读取</h1><div class="post-info">Apr 9, 2017<span class="categories"><i class="fa fa-bookmark" aria-hidden="true"></i></span><a href="/categories/Android技术/" class="post-category">#Android技术</a></div><div class="post-content"><p>根据<a href="http://blog.csdn.net/jiangwei0910410003/article/details/52238891" target="_blank" rel="external">四哥</a>教程来自己动手实现一下如何读取微信的聊天记录。以下操作需要在手机Root的情况下进行。<br><a id="more"></a></p>
<h3 id="微信聊天记录保存位置"><a href="#微信聊天记录保存位置" class="headerlink" title="微信聊天记录保存位置"></a>微信聊天记录保存位置</h3><p>微信聊天记录的数据库文件保存在<code>/data/data/com.tencent.mm/MicroMsg/32位字符串/</code>中，名字为<code>EnMicroMsg.db</code>。</p>
<p><img src="/2017/04/09/微信聊天记录读取/微信数据库文件位置.png" alt="微信数据库文件位置"></p>
<h3 id="将聊天记录数据库文件导出"><a href="#将聊天记录数据库文件导出" class="headerlink" title="将聊天记录数据库文件导出"></a>将聊天记录数据库文件导出</h3><p>使用命令：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">adb pull /data/data/com.tencent.mm/MicroMsg/32位字符串/EnMicroMsg.db</div></pre></td></tr></table></figure></p>
<p><img src="/2017/04/09/微信聊天记录读取/导出1.png" alt="导出1"><br>直接导出提示不存在，因为是权限的问题。<br>使用adb root没反应，只好将文件copy到一个非root权限可以操作的目录，这里采用了<code>/data/local/tmp</code>文件夹。<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">cp EnMicroMsg.db /data/<span class="built_in">local</span>/tmp/</div></pre></td></tr></table></figure></p>
<p>然后导出，执行命令<code>adb pull /data/local/tmp/EnMicroMsg.db</code></p>
<p><img src="/2017/04/09/微信聊天记录读取/权限不足.png" alt="权限不足"></p>
<p>提示权限不足，修改权限后导出。</p>
<p><img src="/2017/04/09/微信聊天记录读取/修改权限导出.png" alt="修改权限导出"></p>
<h3 id="查看SharedPreferences中保存的UIN的值"><a href="#查看SharedPreferences中保存的UIN的值" class="headerlink" title="查看SharedPreferences中保存的UIN的值"></a>查看SharedPreferences中保存的UIN的值</h3><p>切换到<code>/data/data/com.tencent.mm/shared_prefs</code>目录，然后执行<code>grep -rn &quot;uin&quot; *</code>来查看保存的UIN的值</p>
<p><img src="/2017/04/09/微信聊天记录读取/Shared_Pre文件.png" alt="Shared_Pre文件"><br><img src="/2017/04/09/微信聊天记录读取/查看UIN的值.png" alt="查看UIN的值"></p>
<h3 id="读取微信数据库文件内容"><a href="#读取微信数据库文件内容" class="headerlink" title="读取微信数据库文件内容"></a>读取微信数据库文件内容</h3><p>将手机的IMEI和微信用户UIN值进行拼接后进行md5加密，取小写md5的前七位就是微信数据库的密码。<br>用Navicat读取数据库文件是提示错误：<br><img src="/2017/04/09/微信聊天记录读取/Navicat读取数据库文件时提示错误.png" alt="Navicat读取数据库文件时提示错误"><br>这是因为微信数据库用的是SQLCipher开源库提供的加密解密算法，读取数据库文件需要使用SQLCipher这个软件。<br>打开后输入密码，即可看到聊天内容：<br><img src="/2017/04/09/微信聊天记录读取/微信聊天记录.png" alt="微信聊天记录"></p>
<h3 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h3><p><a href="http://blog.csdn.net/jiangwei0910410003/article/details/52238891" target="_blank" rel="external">http://blog.csdn.net/jiangwei0910410003/article/details/52238891</a> </p>
</div><p class="post-tags"><i class="fa fa-tags" aria-hidden="true"></i><a href="/tags/微信聊天记录/">#微信聊天记录</a></p></article></div><footer><div class="paginator"><a href="/2017/04/10/QQ登录简单分析，附易语言登录代码/" class="prev">上一篇</a><a href="/2017/04/01/Android-HOOK-技术之Frida的初级使用/" class="next">下一篇</a></div><div class="copyright"><p>© 2016 - 2017 <a href="http://fuping.site">浮萍</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-103156844-1",'auto');ga('send','pageview');</script><link rel="stylesheet" href="//cdn.datatables.net/1.10.7/css/jquery.dataTables.min.css" media="screen" type="text/css"><script src="//cdn.datatables.net/1.10.7/js/jquery.dataTables.min.js"></script><script>$(function(){$('.datatable').dataTable( {"order": [[ 0, "desc" ]],"iDisplayLength": -1,"lengthMenu": [[10, 25, 50, -1], [10, 25, 50, "All"]]} );});</script></body></html>